<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>WASdown</title>
  <meta name="description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="WASdown" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo_bw.png" />
  <meta property="og:description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="WASdown" />
  
  <meta name="twitter:description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17" />
  <meta name="twitter:image" content="images/logo_bw.png" />

<meta name="author" content="Morgan Brand and Robert Schlegel">


<meta name="date" content="2017-06-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="bananas.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The use of R Rstudio and Github</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r-for-data-science"><i class="fa fa-check"></i><b>1.1</b> <a href="http://r4ds.had.co.nz/index.html">R for Data Science</a></a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.1.1</b> R</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#the-tidyverse"><i class="fa fa-check"></i><b>1.1.3</b> The tidyverse</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>1.1.4</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#thesisdown"><i class="fa fa-check"></i><b>1.2</b> <a href="https://github.com/ismayc/thesisdown">Thesisdown</a></a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#the-basic-filing-structure"><i class="fa fa-check"></i><b>1.2.1</b> The basic filing structure</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#pdf-output"><i class="fa fa-check"></i><b>1.2.2</b> PDF output</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#yaml"><i class="fa fa-check"></i><b>1.2.3</b> YAML</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#blogdown"><i class="fa fa-check"></i><b>1.3</b> <a href="https://github.com/rstudio/blogdown">Blogdown</a></a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#git-and-github"><i class="fa fa-check"></i><b>1.4</b> Git and Github</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#why-git"><i class="fa fa-check"></i><b>1.4.1</b> Why Git?</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#why-github"><i class="fa fa-check"></i><b>1.4.2</b> Why GitHub?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#twitterverse"><i class="fa fa-check"></i><b>1.5</b> Twitterverse</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="petrol.html"><a href="petrol.html"><i class="fa fa-check"></i><b>2</b> Petrol</a><ul>
<li class="chapter" data-level="2.1" data-path="petrol.html"><a href="petrol.html#loading-and-prepping-the-data"><i class="fa fa-check"></i><b>2.1</b> Loading and prepping the data</a></li>
<li class="chapter" data-level="2.2" data-path="petrol.html"><a href="petrol.html#distances-traveled"><i class="fa fa-check"></i><b>2.2</b> Distances traveled</a></li>
<li class="chapter" data-level="2.3" data-path="petrol.html"><a href="petrol.html#spending-behaviour"><i class="fa fa-check"></i><b>2.3</b> Spending behaviour</a></li>
<li class="chapter" data-level="2.4" data-path="petrol.html"><a href="petrol.html#petrol-usage-per-km"><i class="fa fa-check"></i><b>2.4</b> Petrol usage per km</a></li>
<li class="chapter" data-level="2.5" data-path="petrol.html"><a href="petrol.html#petrol-prices"><i class="fa fa-check"></i><b>2.5</b> Petrol prices</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bananas.html"><a href="bananas.html"><i class="fa fa-check"></i><b>3</b> Bananas</a><ul>
<li class="chapter" data-level="3.1" data-path="bananas.html"><a href="bananas.html#loading-the-data"><i class="fa fa-check"></i><b>3.1</b> Loading the data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bananas.html"><a href="bananas.html#setting-date"><i class="fa fa-check"></i><b>3.1.1</b> Setting date</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bananas.html"><a href="bananas.html#investigating-by-bunch"><i class="fa fa-check"></i><b>3.2</b> Investigating by bunch</a><ul>
<li class="chapter" data-level="3.2.1" data-path="bananas.html"><a href="bananas.html#bunches-per-month"><i class="fa fa-check"></i><b>3.2.1</b> Bunches per month</a></li>
<li class="chapter" data-level="3.2.2" data-path="bananas.html"><a href="bananas.html#statistics"><i class="fa fa-check"></i><b>3.2.2</b> Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="bananas.html"><a href="bananas.html#investigating-by-field"><i class="fa fa-check"></i><b>3.3</b> Investigating by field</a><ul>
<li class="chapter" data-level="3.3.1" data-path="bananas.html"><a href="bananas.html#cumulative-bunches-per-field"><i class="fa fa-check"></i><b>3.3.1</b> Cumulative bunches per field</a></li>
<li class="chapter" data-level="3.3.2" data-path="bananas.html"><a href="bananas.html#cumulative-weight-per-field"><i class="fa fa-check"></i><b>3.3.2</b> Cumulative weight per field</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bananas.html"><a href="bananas.html#production-per-hectare"><i class="fa fa-check"></i><b>3.4</b> Production per hectare</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>4</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WASdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="petrol" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Petrol</h1>
<p>This report shows analyses performed and figures created from 10+ years of petrol usage with a 2003 Volkswagen Polo sedan (1.4).</p>
<p><img src="images/vw_polo.jpg" width="75%" /></p>
<p>The purpose is to illustrate the use of Rmarkdown with data analyses.</p>
<div id="loading-and-prepping-the-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Loading and prepping the data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load libraries</span>
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(broom)</code></pre></div>
<pre><code>## Warning: package &#39;broom&#39; was built under R version 3.3.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load data</span>
petrol &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/petrol_info.csv&quot;</span>)

<span class="co"># Correct date</span>
petrol$date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(petrol$date, <span class="st">&quot;%d-%m-%y&quot;</span>)

<span class="co"># Correct &#39;full&#39; categorical label</span>
petrol$full[<span class="kw">is.na</span>(petrol$full)] &lt;-<span class="st"> </span><span class="dv">0</span>
petrol$full &lt;-<span class="st"> </span><span class="kw">factor</span>(petrol$full, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>))
petrol$full &lt;-<span class="st"> </span><span class="kw">factor</span>(petrol$full, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>))

<span class="co"># Remove problem rows</span>
petrol &lt;-<span class="st"> </span>petrol[<span class="kw">complete.cases</span>(petrol),]

<span class="co"># Add month and year columns</span>
petrol$month &lt;-<span class="st"> </span><span class="kw">floor_date</span>(petrol$date, <span class="st">&quot;month&quot;</span>)
petrol$year &lt;-<span class="st"> </span><span class="kw">floor_date</span>(petrol$date, <span class="st">&quot;year&quot;</span>)

<span class="co"># Create a column showing distance between fill-ups</span>
petrol$dist &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">diff</span>(<span class="kw">as.matrix</span>(petrol$odom)))

<span class="co"># Total distance traveled</span>
petrol$dist_total &lt;-<span class="st"> </span>petrol$odom-petrol$odom[<span class="dv">1</span>]</code></pre></div>
</div>
<div id="distances-traveled" class="section level2">
<h2><span class="header-section-number">2.2</span> Distances traveled</h2>
<p>Over the lifespan of a vehicle, one constant will always be the increasing count of the odometre. We may plot this as a time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> petrol, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> odom)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">80000</span>, <span class="dv">200000</span>, <span class="dv">20000</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;distance (km)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-12"></span>
<img src="WASdown_files/figure-html/unnamed-chunk-12-1.png" alt="Line graph showing total distance traveled (km) over time." width="672" />
<p class="caption">
Figure 2.1: Line graph showing total distance traveled (km) over time.
</p>
</div>
<p>Also of interest is how far the distances between fill ups may be. There are a couple of gaps in this time series, which lend themselves to some dramatic numbers, but overall we are able to get an idea of the true distances.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> petrol[petrol$dist &lt;=<span class="st"> </span><span class="dv">1000</span>,], <span class="kw">aes</span>(<span class="dt">x =</span> dist)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;violet&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey40&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="WASdown_files/figure-html/unnamed-chunk-13-1.png" alt="Histogram showing the distances traveled between fillings. Any values over 1,000 km were subsetted out." width="672" />
<p class="caption">
Figure 2.2: Histogram showing the distances traveled between fillings. Any values over 1,000 km were subsetted out.
</p>
</div>
<p>This histogram shows a bimodal distribution with a clustering of distances around 100 kms and 600 kms. This is not so strange if you think about it as it shows that this driver would tend to either go short distances between filling up, or long distances. This is likely linked to spending behaviours, which is the next thing to investigate.</p>
</div>
<div id="spending-behaviour" class="section level2">
<h2><span class="header-section-number">2.3</span> Spending behaviour</h2>
<p>We may produce another histogram to plot the amount of money spent per visit to the petrol station.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> petrol, <span class="kw">aes</span>(<span class="dt">x =</span> cost)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> full), <span class="dt">colour =</span> <span class="st">&quot;grey40&quot;</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Price (R)&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-14"></span>
<img src="WASdown_files/figure-html/unnamed-chunk-14-1.png" alt="Histogram showing the amount of money spent per visit to the petrol station. The colours show if the tank was filled during that visit or not." width="672" />
<p class="caption">
Figure 2.3: Histogram showing the amount of money spent per visit to the petrol station. The colours show if the tank was filled during that visit or not.
</p>
</div>
<p>This histogram is showing two different spending habits. On the left hand side we see that there are distinct columns rising out from the others. This is when the driver went to the station and spent specifically, R20, R50, R100, R200, R300 or R400. On the right hand side of the histogram we see a more normal distribution of columns. These are the prices spent when filling up the tank to full.</p>
</div>
<div id="petrol-usage-per-km" class="section level2">
<h2><span class="header-section-number">2.4</span> Petrol usage per km</h2>
<p>One of the first things any car owner wants to know about their vehicle is the mileage their vehicle is getting. And whether or not this is decreasing with wear. Because we don’t know exactly how much petrol is used between each fill up this becomes a bit tricky. We overcome this challenge somewhat by creating annual sums of petrol use. With these we may then calculate the distance traveled per litre more broadly. Monthly means are too erratic to be useful.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create monthly means</span>
petrol_annual &lt;-<span class="st"> </span>petrol %&gt;%
<span class="st">  </span><span class="kw">select</span>(-full, -date, -month) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(year) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dist2 =</span> <span class="kw">sum</span>(dist)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">litre2 =</span> <span class="kw">sum</span> (litre)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(mean) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dist_litre =</span> dist2/litre2)

<span class="co"># Remove outliers caused during absences</span>
<span class="kw">is.na</span>(petrol_annual$dist_litre) &lt;-<span class="st"> </span>petrol_annual$dist_litre &gt;<span class="st"> </span><span class="dv">16</span>

<span class="co"># Plot it</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> petrol_annual, <span class="kw">aes</span> (<span class="dt">x =</span> year, <span class="dt">y =</span> dist_litre)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;km/litre&quot;</span>, <span class="dt">x =</span> <span class="ot">NULL</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-15"></span>
<img src="WASdown_files/figure-html/unnamed-chunk-15-1.png" alt="Line graph showing the progression of the cars mileabe over time. A linear model (blue) and non-linear model (red) are fitted to these data. The grey areas around the fitted models show the standard error (se) of the fit." width="672" />
<p class="caption">
Figure 2.4: Line graph showing the progression of the cars mileabe over time. A linear model (blue) and non-linear model (red) are fitted to these data. The grey areas around the fitted models show the standard error (se) of the fit.
</p>
</div>
<p>As we may see, the mileage appears to increase until 2013 when it then falls precipitously. The overall change in mileage for this car however appears flat when modeled linearly.</p>
</div>
<div id="petrol-prices" class="section level2">
<h2><span class="header-section-number">2.5</span> Petrol prices</h2>
<p>We’ve saved the best for last as the most interesting thing for most people that could be extracted from these records is the price of petrol over the last decade. Both how much petrol costs per litre and how much must be spent every time we pull up to the station. First we see a lolliplot of how much was spent at each station visit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate total amount spent</span>
petrol$cost_total &lt;-<span class="st"> </span><span class="kw">cumsum</span>(petrol$cost)

<span class="co"># Lolli plot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> petrol, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> cost)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> full)) +
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">xend =</span> date, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> cost, <span class="dt">colour =</span> full)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;cost (R)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-16"></span>
<img src="WASdown_files/figure-html/unnamed-chunk-16-1.png" alt="Lolliplot showing ." width="672" />
<p class="caption">
Figure 2.5: Lolliplot showing .
</p>
</div>
<p>And then the price per litre averaged per month.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Price/ litre/ month</span>
petrol_monthly &lt;-<span class="st"> </span>petrol %&gt;%
<span class="st">  </span><span class="kw">select</span>(-full, -date, -year) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(month) %&gt;%
<span class="st">  </span><span class="kw">summarise_all</span>(mean) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">price_litre =</span> cost/litre)

<span class="co"># Fill in missing months</span>
month_index &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">month =</span> <span class="kw">seq</span>(petrol_monthly$month[<span class="dv">1</span>], 
                                      petrol_monthly$month[<span class="kw">nrow</span>(petrol_monthly)], <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>))
petrol_monthly &lt;-<span class="st"> </span><span class="kw">merge</span>(petrol_monthly, month_index, <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>, <span class="dt">all.y =</span> <span class="ot">TRUE</span>)

petrol_trend &lt;-<span class="st"> </span><span class="kw">lm</span>(petrol_monthly$price_litre ~<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(petrol_monthly)))
petrol_augment &lt;-<span class="st"> </span><span class="kw">augment</span>(petrol_trend)
petrol_tidy &lt;-<span class="st"> </span><span class="kw">tidy</span>(petrol_trend)
petrol_glance &lt;-<span class="st"> </span><span class="kw">glance</span>(petrol_trend)
<span class="co"># petrol_tidy$estimate[2]*12</span>
<span class="co"># R 0.72/ month</span>

<span class="co"># Line graph</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> petrol_monthly, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> price_litre)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2009-01-01&quot;</span>), <span class="dt">y =</span> <span class="dv">13</span>, 
                <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;Increase = R&quot;</span>, <span class="kw">round</span>(petrol_tidy$estimate[<span class="dv">2</span>]*<span class="dv">12</span>, <span class="dv">2</span>), <span class="st">&quot;/year&quot;</span>))) +
<span class="st">  </span><span class="co"># geom_point(data = petrol[187,], colour = &quot;red&quot;)</span>
<span class="st">  </span><span class="co"># scale_y_continuous(breaks = seq(80000, 200000, 20000)) +</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;R/litre&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="WASdown_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>And there we have it. Petrol prices in SA have increased R0.72/year over the last 10 years.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bananas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-petrol.Rmd",
"text": "Edit"
},
"download": ["WASdown.pdf", "WASdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
