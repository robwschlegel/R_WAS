<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>WASdown</title>
  <meta name="description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="WASdown" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo_bw.png" />
  <meta property="og:description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17" />
  <meta name="github-repo" content="<a href="https://github.com/schrob040/R_WAS" class="uri">https://github.com/schrob040/R_WAS</a>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="WASdown" />
  
  <meta name="twitter:description" content="This book is built as an infomration package meant for the student workshop at #WorldAqua17" />
  <meta name="twitter:image" content="images/logo_bw.png" />

<meta name="author" content="Morgan Brand and Robert Schlegel">


<meta name="date" content="2017-06-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="petrol-usage-per-km.html">
<link rel="next" href="bananas.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The use of R Rstudio and Github</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#excerpt-from-r-for-data-science"><i class="fa fa-check"></i><b>1.1</b> Excerpt from <a href="http://r4ds.had.co.nz/index.html">R for Data Science</a></a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.1.1</b> R</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#the-tidyverse"><i class="fa fa-check"></i><b>1.1.3</b> The tidyverse</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>1.1.4</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#thesisdown"><i class="fa fa-check"></i><b>1.2</b> Thesisdown</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#blogdown"><i class="fa fa-check"></i><b>1.3</b> Blogdown</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#git-and-github"><i class="fa fa-check"></i><b>1.4</b> Git and Github</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#why-git"><i class="fa fa-check"></i><b>1.4.1</b> Why Git?</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#why-github"><i class="fa fa-check"></i><b>1.4.2</b> Why GitHub?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#twitterverse"><i class="fa fa-check"></i><b>1.5</b> Twitterverse</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="petrol.html"><a href="petrol.html"><i class="fa fa-check"></i><b>2</b> Petrol</a></li>
<li class="chapter" data-level="3" data-path="odometre.html"><a href="odometre.html"><i class="fa fa-check"></i><b>3</b> Odometre</a></li>
<li class="chapter" data-level="4" data-path="spending-patterns.html"><a href="spending-patterns.html"><i class="fa fa-check"></i><b>4</b> Spending patterns</a></li>
<li class="chapter" data-level="5" data-path="petrol-usage-per-km.html"><a href="petrol-usage-per-km.html"><i class="fa fa-check"></i><b>5</b> Petrol usage per km</a></li>
<li class="chapter" data-level="6" data-path="petrol-prices.html"><a href="petrol-prices.html"><i class="fa fa-check"></i><b>6</b> Petrol prices</a></li>
<li class="chapter" data-level="7" data-path="bananas.html"><a href="bananas.html"><i class="fa fa-check"></i><b>7</b> Bananas</a></li>
<li class="chapter" data-level="8" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>8</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WASdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="petrol-prices" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Petrol prices</h1>
<p>Of interest to everyone is the price of petrol. Both how much we have spent and how much we have to spend every time we pull up to the station. First we see a lolliplot of spending behaviour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate total amount spent</span>
petrol$cost_total &lt;-<span class="st"> </span><span class="kw">cumsum</span>(petrol$cost)

<span class="co"># Lolli plot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> petrol, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> cost)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">xend =</span> date, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> cost)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;cost (R)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="WASdown_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> petrol, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> cost_total)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre></div>
<p><img src="WASdown_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>And then the price per litre averaged per month.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Price/ litre/ month</span>
petrol_monthly &lt;-<span class="st"> </span>petrol %&gt;%
<span class="st">  </span><span class="kw">select</span>(-full, -date, -year) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(month) %&gt;%
<span class="st">  </span><span class="kw">summarise_all</span>(mean) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">price_litre =</span> cost/litre)

<span class="co"># Fill in missing months</span>
month_index &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">month =</span> <span class="kw">seq</span>(petrol_monthly$month[<span class="dv">1</span>], petrol_monthly$month[<span class="kw">nrow</span>(petrol_monthly)], <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>))
petrol_monthly &lt;-<span class="st"> </span><span class="kw">merge</span>(petrol_monthly, month_index, <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>, <span class="dt">all.y =</span> <span class="ot">TRUE</span>)

petrol_trend &lt;-<span class="st"> </span><span class="kw">lm</span>(petrol_monthly$price_litre ~<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(petrol_monthly)))
petrol_augment &lt;-<span class="st"> </span><span class="kw">augment</span>(petrol_trend)
petrol_tidy &lt;-<span class="st"> </span><span class="kw">tidy</span>(petrol_trend)
petrol_glance &lt;-<span class="st"> </span><span class="kw">glance</span>(petrol_trend)
petrol_tidy$estimate[<span class="dv">2</span>]*<span class="dv">12</span></code></pre></div>
<pre><code>## [1] 0.7226146</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R 0.72/ month</span>

<span class="co"># Line graph</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> petrol_monthly, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> price_litre)) +
<span class="st">  </span><span class="kw">geom_line</span>() +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2009-01-01&quot;</span>), <span class="dt">y =</span> <span class="dv">13</span>, 
                <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;Increase = R&quot;</span>, <span class="kw">round</span>(petrol_tidy$estimate[<span class="dv">2</span>]*<span class="dv">12</span>, <span class="dv">2</span>), <span class="st">&quot; /month&quot;</span>))) +
<span class="st">  </span><span class="co"># geom_point(data = petrol[187,], colour = &quot;red&quot;)</span>
<span class="st">  </span><span class="co"># scale_y_continuous(breaks = seq(80000, 200000, 20000)) +</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;price/ litre&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="WASdown_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="petrol-usage-per-km.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bananas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-petrol.Rmd",
"text": "Edit"
},
"download": ["WASdown.pdf", "WASdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
